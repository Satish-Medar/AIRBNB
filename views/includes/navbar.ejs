<style>
  /*
  --- Base & Utility Styles ---
  */
  .container-fluid {
    /* Slightly lighter than white for a subtle background */
    background-color: #fbfbfb;
  }

  /* Brand logo sizing */
  .brand-logo {
    max-height: 80px;
    height: auto;
    width: auto;
    display: block;
  }

  /*
  --- Right Side: Become a Host Button ---
  */
  .btn-host {
    /* Fixed width and height for consistent size */
    width: 150px;
    height: 40px;
    background-color: transparent;
    border: none;
    transition: background-color 0.2s;
    /* Use flexbox to center content */
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Target the anchor tag inside the button */
  .btn-host a {
    text-decoration: none;
    /* Remove underline from link */
    color: #222;
    /* Dark color for text */
  }

  .btn-host h6 {
    font-size: 1rem;
    /* Standardizing font size */
    font-weight: 700;
    margin: 0;
    /* Remove default margin */
  }

  .btn-host:hover {
    background-color: #f0f0f0;
    /* Lighter grey on hover */
    border-radius: 25px;
    /* Apply border-radius here */
  }

  /*
  --- Right Side: Circular Icons (Globe, Menu) ---
  */
  .nav-icon {
    height: 3rem;
    width: 3rem;
    border-radius: 50%;
    padding: 0.75rem;
    background-color: #e2e1e1;
    transition: background-color 0.2s;
    border: none;
    /* Ensure no default button border */
  }

  .nav-icon:hover {
    background-color: #dcdbdb;
  }

  .nav-icon i {
    font-size: 1.25rem;
    /* Standardize icon size */
  }

  /*
  --- Center Nav Links (Homes, Experiences, Services) ---
  */
  .nav-link-btn {
    border: none;
    background-color: transparent;
    padding: 0.5rem 1rem;
    /* Adjust padding for better clickable area */
    margin: 0 0.5rem;
    /* Reduced horizontal margin for tighter grouping */
    transition: all 0.2s ease;
    display: flex;
    /* Enable flex for inner content */
    align-items: center;
  }

  .nav-link-btn:hover {
    text-decoration: underline;
  }

  .nav-cen-ico i {
    font-size: 1.8rem;
    /* Slightly smaller for better balance */
    transition: transform 0.3s ease;
    color: #222;
    /* Darker color for icons */
  }

  .nav-link-btn:hover .nav-cen-ico i {
    transform: scale(1.15);
    /* Subtle scale up on hover */
  }

  .nav-cen-ico h6 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0;
    color: #222;
  }

  /*
  --- Center Nav Link Badges ---
  */
  .notification-badge {
    /* Positioning relative to the parent icon */
    position: absolute;
    top: -5px;
    right: -10px;
    font-size: 0.7rem !important;
    /* Smaller badge text */
    padding: 2px 5px;
  }

  /*
  --- Center Search Bar Component ---
  */
  .search-bar-container {
    width: 100%;
    max-width: 900px;
    /* Keep the viewport-relative width */
    height: 60px;
    /* Standard height for search bar */
    border-radius: 30px;
    border: 1px solid #ddd;
    display: flex;
    align-items: center;
    /* Vertically align content */
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
    /* Subtle shadow */
    transition: box-shadow 0.2s ease;
  }

  .search-bar-container:hover {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    /* More prominent shadow on hover */
  }

  .search-group {
    flex-grow: 1;
    /* Allows this group to take up remaining space */
    display: flex;
    height: 100%;
    /* Match parent height */
  }

  .search-group-btn {
    flex: 1 1 33.333%;
    /* Ensures perfect third distribution for alignment */
    padding: 0 16px;
    background-color: transparent;
    border: none;
    cursor: pointer;
    text-align: left;
    height: 100%;
    /* Subtle separator lines */
    border-right: 1px solid transparent;
    transition: background-color 0.2s, border-color 0.2s;
  }

  /* Add dividers and hover effects */
  .search-group-btn:nth-child(1),
  .search-group-btn:nth-child(2) {
    border-right-color: #ddd;
    /* Visible divider */
  }

  .search-group-btn:hover {
    background-color: #e9e9e9;
    border-radius: 30px;
  }

  /* Specific hover adjustments for corner buttons */
  .search-group-btn:nth-child(1):hover {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  .search-group-btn:nth-child(3):hover {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  .search-group-btn h6 {
    font-size: 0.875rem;
    /* Smaller, bolded header */
    font-weight: 600;
    margin-bottom: 2px;
  }

  .search-group-btn p {
    font-size: 0.8rem;
    color: #717171;
    margin: 0;
  }

  /* Search Icon Button */
  .search-icon-btn {
    background-color: #fe424d;
    /* Airbnb Red */
    border: none;
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    margin-right: 8px;
    /* Spacing from the end */
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    /* Prevents shrinking */
  }

  .search-icon-btn i {
    font-size: 1rem;
  }

  /* Profile Dropdown Menu Styling */
  .profile-menu-item {
    padding: 0.5rem 1rem;
    text-decoration: none;
    color: #222;
    transition: background-color 0.1s;
  }

  .profile-menu-item:hover {
    background-color: #f0f0f0;
  }

  .profile-menu-item.fw-bold {
    font-weight: 700;
  }

  /* Responsive Adjustments */
  @media (max-width: 1200px) {
    .search-bar-container {
      width: 100%;
    }
  }

  @media (max-width: 992px) {
    .center-nav-links {
      display: none !important;
    }

    .top-nav-row {
      justify-content: space-between !important;
    }

    /* Reduce logo size on smaller screens */
    .brand-logo {
      max-height: 56px;
    }

    .search-bar-container {
      height: 52px;
      border-radius: 26px;
    }
  }

  @media (max-width: 576px) {
    .brand-logo {
      max-height: 44px;
    }

    .search-bar-container {
      height: 48px;
      border-radius: 24px;
    }
  }
</style>

<nav class="container-fluid py-3 sticky-top">
  <div class="row align-items-center justify-content-between">
    <div class="col-auto ms-4">
      <a href="/listings">
        <img class="brand-logo" src="https://res.cloudinary.com/dxtd9gpz2/image/upload/v1763806107/airbnb-logo_2_mk0u0u.png"
          alt="airbnb-logo" />
      </a>
      <a class="nav-link d-none d-lg-inline-block fw-bold" href="/listings">All Listings</a>
    </div>

    <div class="col-lg-auto d-none d-lg-flex justify-content-center center-nav-links mx-auto">
      <div class="d-flex align-items-center">
        <button class="nav-link-btn">
          <span class="d-flex nav-cen-ico align-items-center">
            <i class="fa-regular fa-house me-2"></i>
            <h6>Homes</h6>
          </span>
        </button>

        <button class="nav-link-btn">
          <span class="d-flex nav-cen-ico align-items-center position-relative">
            <span class="position-relative d-inline-block me-2">
              <i class="fa-solid fa-parachute-box"></i>
              <span class="badge rounded-pill bg-danger position-absolute notification-badge">
                NEW
              </span>
            </span>
            <h6>Experiences</h6>
          </span>
        </button>

        <button class="nav-link-btn">
          <span class="d-flex nav-cen-ico align-items-center position-relative">
            <span class="position-relative d-inline-block me-2">
              <i class="fa-solid fa-bell"></i>
              <span class="badge rounded-pill bg-danger position-absolute notification-badge">
                NEW
              </span>
            </span>
            <h6>Services</h6>
          </span>
        </button>
      </div>
    </div>

    <div class="col-auto d-flex align-items-center me-4">
      <button type="button" class="btn-host rounded-pill">
        <a href="/listings/new">
          <h6 class="fw-semibold">Become a host</h6>
        </a>
      </button>

      <button type="button" class="btn nav-icon ms-2">
        <i class="fa-solid fa-globe"></i>
      </button>

      <div class="dropdown ms-2">
        <button type="button" class="btn nav-icon" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fa-solid fa-bars"></i>
        </button>

        <ul class="dropdown-menu dropdown-menu-end shadow-sm" aria-labelledby="profileDropdown">
          <li>
            <a class="dropdown-item profile-menu-item fw-bold" href="#">Messages</a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item fw-bold" href="#">Notifications</a>
          </li>
          <li>
            <hr class="dropdown-divider" />
          </li>
          <li>
            <a class="dropdown-item profile-menu-item" href="/listings/new">Airbnb your home</a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item" href="#">Account</a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item" href="/logout"><b>Logout</b></a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item fw-bold" href="/signup"><b>Signup</b></a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item fw-bold" href="/login"><b>Login</b></a>
          </li>
          <li>
            <hr class="dropdown-divider" />
          </li>
          <li>
            <a class="dropdown-item profile-menu-item" href="/listings/new">Airbnb your home</a>
          </li>
          <li>
            <a class="dropdown-item profile-menu-item" href="#">Help Center</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row mt-2">
    <div class="col-12 d-flex justify-content-center">
      <div class="search-bar-container">
        <div class="search-group">
          <button class="search-group-btn">
            <h6>Where</h6>
            <p>Search Destinations</p>
          </button>
          <button class="search-group-btn">
            <h6>Check in/out</h6>
            <p>Add Dates</p>
          </button>
          <button class="search-group-btn">
            <h6>Who</h6>
            <p>Add Guests</p>
          </button>
        </div>

        <div>
          <form action="/listings" method="GET" class="d-flex" role="search" aria-label="Site search">
            <input name="q" class="form-control me-2" list="search-suggestions" type="search" placeholder="Search listings by title" aria-label="Search" id="searchInput" autocomplete="off" />
            <datalist id="search-suggestions"></datalist>
            <button class="search-icon-btn" type="submit" aria-label="Search">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </form>
        </div>
      </div>
    </div>
</nav>
<!-- Removed broken client-side script. Form uses GET and the server handles search via the `q` query parameter. -->

<script>
  (function(){
    const input = document.getElementById('searchInput');
    const dataList = document.getElementById('search-suggestions');
    let timer = null;

    async function fetchSuggestions(q){
      try{
        const res = await fetch(`/listings/autocomplete?q=${encodeURIComponent(q)}`);
        if(!res.ok) return [];
        const list = await res.json();
        return list;
      }catch(e){
        return [];
      }
    }

    input.addEventListener('input', (e)=>{
      const v = e.target.value;
      if(timer) clearTimeout(timer);
      if(!v || v.trim().length < 1){
        dataList.innerHTML = '';
        return;
      }
      timer = setTimeout(async ()=>{
        const suggestions = await fetchSuggestions(v);
        dataList.innerHTML = '';
        suggestions.forEach(s=>{
          const opt = document.createElement('option');
          opt.value = s;
          dataList.appendChild(opt);
        });
      }, 220);
    });
  })();
</script>